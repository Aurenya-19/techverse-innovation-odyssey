<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TechVerse: Ultimate Learning Experience</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Segoe UI', Tahoma, sans-serif; overflow: hidden; background: #000; color: #e0e0e0; }
#renderCanvas { width: 100vw; height: 100vh; display: block; touch-action: none; cursor: crosshair; }

#charSelect { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 10000; }
#charSelect h1 { font-size: clamp(2.5em, 5vw, 4em); color: #fff; text-shadow: 0 0 30px rgba(0, 212, 255, 0.8); margin-bottom: 20px; font-weight: 800; letter-spacing: 3px; animation: glow 2s ease-in-out infinite; }
@keyframes glow { 0%, 100% { text-shadow: 0 0 30px rgba(0, 212, 255, 0.8); } 50% { text-shadow: 0 0 50px rgba(0, 212, 255, 1), 0 0 80px rgba(0, 212, 255, 0.6); } }
.subtitle { font-size: clamp(1em, 2vw, 1.3em); color: #bdc3c7; margin-bottom: 40px; text-align: center; max-width: 900px; line-height: 1.8; padding: 0 20px; }
.charGrid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; max-width: 1100px; width: 90%; margin-bottom: 40px; }
.charCard { background: linear-gradient(135deg, rgba(52, 73, 94, 0.9), rgba(44, 62, 80, 0.9)); border: 3px solid #3498db; border-radius: 15px; padding: 30px; cursor: pointer; transition: all 0.4s; text-align: center; backdrop-filter: blur(15px); position: relative; overflow: hidden; }
.charCard::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(52, 152, 219, 0.1), transparent); transform: rotate(45deg); transition: all 0.6s; }
.charCard:hover::before { left: 100%; }
.charCard:hover { transform: translateY(-10px) scale(1.05); border-color: #00d4ff; box-shadow: 0 15px 50px rgba(0, 212, 255, 0.4); }
.charCard.selected { background: linear-gradient(135deg, rgba(39, 174, 96, 0.4), rgba(46, 204, 113, 0.4)); border-color: #27ae60; box-shadow: 0 0 40px rgba(39, 174, 96, 0.6); }
.charCard .icon { font-size: 3.5em; margin-bottom: 15px; filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.3)); }
.charCard h3 { color: #ecf0f1; font-size: 1.4em; margin: 12px 0; font-weight: 700; }
.charCard p { color: #95a5a6; font-size: 1em; line-height: 1.5; }
#startBtn { padding: 20px 70px; font-size: 1.5em; background: linear-gradient(135deg, #27ae60, #229954); border: none; border-radius: 50px; color: #fff; font-weight: 800; cursor: pointer; text-transform: uppercase; letter-spacing: 3px; box-shadow: 0 10px 40px rgba(39, 174, 96, 0.5); transition: all 0.4s; position: relative; overflow: hidden; }
#startBtn::before { content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0; border-radius: 50%; background: rgba(255, 255, 255, 0.3); transform: translate(-50%, -50%); transition: width 0.6s, height 0.6s; }
#startBtn:hover::before { width: 400px; height: 400px; }
#startBtn:hover:not(:disabled) { transform: translateY(-5px); box-shadow: 0 15px 50px rgba(39, 174, 96, 0.7); }
#startBtn:disabled { opacity: 0.3; cursor: not-allowed; }

#loading { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: linear-gradient(135deg, #0f0c29, #302b63, #24243e); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
#loading h2 { color: #00d4ff; font-size: 2.8em; margin-bottom: 30px; font-weight: 800; text-shadow: 0 0 30px rgba(0, 212, 255, 0.8); animation: pulse 1.5s ease-in-out infinite; }
@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
.spinner { border: 8px solid rgba(0, 212, 255, 0.2); border-top: 8px solid #00d4ff; border-radius: 50%; width: 100px; height: 100px; animation: spin 1s linear infinite; box-shadow: 0 0 40px rgba(0, 212, 255, 0.4); }
@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
#loadText { color: #bdc3c7; font-size: 1.3em; margin-top: 30px; }
#loadProgress { width: 500px; height: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; margin-top: 25px; overflow: hidden; box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.5); }
#loadBar { width: 0%; height: 100%; background: linear-gradient(90deg, #00d4ff, #27ae60, #f39c12); transition: width 0.3s; border-radius: 10px; box-shadow: 0 0 30px rgba(0, 212, 255, 0.6); }

#hud { position: fixed; top: 20px; left: 20px; background: linear-gradient(135deg, rgba(15, 12, 41, 0.95), rgba(36, 36, 62, 0.95)); padding: 25px; border-radius: 15px; border: 2px solid rgba(0, 212, 255, 0.6); min-width: 280px; z-index: 1000; backdrop-filter: blur(20px); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6); }
#hud h3 { color: #00d4ff; font-size: 1.4em; margin-bottom: 15px; border-bottom: 2px solid rgba(0, 212, 255, 0.4); padding-bottom: 10px; font-weight: 800; text-shadow: 0 0 15px rgba(0, 212, 255, 0.5); }
.hudStat { display: flex; justify-content: space-between; margin: 12px 0; font-size: 1.05em; color: #bdc3c7; }
.hudStat .val { color: #27ae60; font-weight: 800; text-shadow: 0 0 10px rgba(39, 174, 96, 0.4); }

#aiAssistant { position: fixed; top: 20px; right: 20px; width: 400px; background: linear-gradient(135deg, rgba(15, 12, 41, 0.95), rgba(36, 36, 62, 0.95)); border-radius: 15px; border: 2px solid rgba(155, 89, 182, 0.6); z-index: 1000; backdrop-filter: blur(20px); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6); }
#aiHeader { background: linear-gradient(135deg, #9b59b6, #8e44ad); padding: 20px; border-radius: 13px 13px 0 0; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
#aiHeader h3 { color: #fff; font-size: 1.3em; font-weight: 800; display: flex; align-items: center; gap: 10px; }
#aiToggle { background: none; border: none; color: #fff; font-size: 1.4em; cursor: pointer; transition: transform 0.3s; }
#aiBody { max-height: 600px; overflow-y: auto; padding: 20px; display: none; }
#aiBody.open { display: block; }
#aiChat { margin-bottom: 20px; max-height: 450px; overflow-y: auto; }
.aiMsg { margin: 15px 0; padding: 15px; border-radius: 12px; line-height: 1.8; font-size: 0.98em; animation: slideIn 0.3s ease-out; }
@keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
.aiMsg.ai { background: linear-gradient(135deg, rgba(155, 89, 182, 0.25), rgba(142, 68, 173, 0.25)); border-left: 4px solid #9b59b6; }
.aiMsg.user { background: linear-gradient(135deg, rgba(52, 152, 219, 0.25), rgba(41, 128, 185, 0.25)); border-left: 4px solid #3498db; text-align: right; }
.aiMsg strong { color: #9b59b6; font-weight: 700; }
#aiInputArea { display: flex; gap: 10px; }
#aiInput { flex: 1; padding: 14px; background: rgba(52, 73, 94, 0.6); border: 2px solid rgba(127, 140, 141, 0.5); border-radius: 10px; color: #ecf0f1; font-size: 1em; transition: all 0.3s; }
#aiInput:focus { outline: none; border-color: #9b59b6; box-shadow: 0 0 15px rgba(155, 89, 182, 0.3); }
#aiSend { padding: 14px 28px; background: linear-gradient(135deg, #9b59b6, #8e44ad); border: none; border-radius: 10px; color: #fff; font-weight: 800; cursor: pointer; transition: all 0.3s; }
#aiSend:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(155, 89, 182, 0.5); }

#interact { position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, rgba(15, 12, 41, 0.98), rgba(36, 36, 62, 0.98)); padding: 35px 50px; border-radius: 20px; border: 3px solid rgba(52, 152, 219, 0.6); max-width: 850px; width: 92%; text-align: center; z-index: 1000; backdrop-filter: blur(25px); box-shadow: 0 15px 50px rgba(0, 0, 0, 0.7); }
#interact h4 { color: #3498db; font-size: 2.2em; margin-bottom: 20px; font-weight: 800; text-shadow: 0 0 20px rgba(52, 152, 219, 0.5); }
#interact p { color: #bdc3c7; font-size: 1.15em; margin-bottom: 25px; line-height: 1.9; }
.actBtn { padding: 16px 40px; background: linear-gradient(135deg, #3498db, #2980b9); border: none; border-radius: 12px; color: #fff; font-weight: 800; cursor: pointer; margin: 12px; font-size: 1.1em; transition: all 0.3s; box-shadow: 0 6px 25px rgba(52, 152, 219, 0.4); text-transform: uppercase; letter-spacing: 1px; }
.actBtn:hover { transform: translateY(-3px); box-shadow: 0 10px 35px rgba(52, 152, 219, 0.6); }

#tutorial { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0, 0, 0, 0.97); z-index: 5000; overflow-y: auto; padding: 40px 20px; }
#tutorialContent { max-width: 1200px; margin: 0 auto; background: linear-gradient(135deg, rgba(15, 12, 41, 0.98), rgba(36, 36, 62, 0.98)); padding: 50px; border-radius: 25px; border: 3px solid rgba(52, 152, 219, 0.6); backdrop-filter: blur(25px); box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8); }
#tutorialContent h2 { color: #00d4ff; font-size: 2.8em; margin-bottom: 30px; text-align: center; font-weight: 800; text-shadow: 0 0 25px rgba(0, 212, 255, 0.6); }
.tutSection { background: linear-gradient(135deg, rgba(52, 73, 94, 0.6), rgba(44, 62, 80, 0.6)); padding: 30px; margin: 25px 0; border-radius: 15px; border-left: 5px solid #27ae60; transition: all 0.3s; }
.tutSection:hover { transform: translateX(5px); box-shadow: 0 8px 30px rgba(39, 174, 96, 0.2); }
.tutSection h3 { color: #27ae60; font-size: 1.8em; margin-bottom: 18px; font-weight: 700; }
.tutSection p { color: #ecf0f1; font-size: 1.1em; line-height: 2; margin: 12px 0; }
.tutSection ul { margin: 20px 0 20px 40px; }
.tutSection li { color: #bdc3c7; margin: 12px 0; line-height: 1.8; font-size: 1.05em; }
.stepBox { background: linear-gradient(135deg, rgba(41, 128, 185, 0.25), rgba(52, 152, 219, 0.25)); padding: 25px; margin: 20px 0; border-radius: 12px; border: 2px solid #3498db; }
.stepBox h4 { color: #3498db; font-size: 1.5em; margin-bottom: 15px; font-weight: 700; }
.stepBox p { color: #ecf0f1; line-height: 1.9; font-size: 1.05em; }
.highlight { color: #f39c12; font-weight: 700; text-shadow: 0 0 10px rgba(243, 156, 18, 0.3); }
.warning { background: linear-gradient(135deg, rgba(231, 76, 60, 0.25), rgba(192, 57, 43, 0.25)); padding: 20px; border-left: 5px solid #e74c3c; margin: 20px 0; border-radius: 10px; }
.warning p { color: #e74c3c; font-weight: 700; font-size: 1.1em; }
.tutBtn { padding: 18px 50px; background: linear-gradient(135deg, #27ae60, #229954); border: none; border-radius: 12px; color: #fff; font-weight: 800; cursor: pointer; margin: 25px 12px; font-size: 1.2em; transition: all 0.3s; box-shadow: 0 8px 30px rgba(39, 174, 96, 0.4); text-transform: uppercase; }
.tutBtn:hover { transform: translateY(-3px); box-shadow: 0 12px 40px rgba(39, 174, 96, 0.6); }
.tutBtn.secondary { background: linear-gradient(135deg, #95a5a6, #7f8c8d); }

#controls { position: fixed; bottom: 40px; left: 40px; background: linear-gradient(135deg, rgba(15, 12, 41, 0.95), rgba(36, 36, 62, 0.95)); padding: 25px; border-radius: 15px; border: 2px solid rgba(0, 212, 255, 0.4); z-index: 1000; backdrop-filter: blur(20px); box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6); }
#controls h4 { color: #00d4ff; margin-bottom: 15px; font-size: 1.2em; font-weight: 800; }
.ctrl { color: #bdc3c7; margin: 10px 0; font-size: 1em; }
.key { color: #27ae60; font-weight: 800; background: linear-gradient(135deg, rgba(39, 174, 96, 0.25), rgba(46, 204, 113, 0.25)); padding: 5px 12px; border-radius: 8px; margin-right: 10px; border: 1px solid rgba(39, 174, 96, 0.4); display: inline-block; }

#notif { position: fixed; top: 150px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #27ae60, #229954); color: #fff; padding: 20px 50px; border-radius: 50px; font-weight: 800; font-size: 1.2em; opacity: 0; transition: opacity 0.4s; max-width: 92%; text-align: center; z-index: 2000; box-shadow: 0 10px 40px rgba(39, 174, 96, 0.6); }
#notif.show { opacity: 1; animation: notifBounce 0.5s ease-out; }
@keyframes notifBounce { 0% { transform: translateX(-50%) translateY(-20px); } 50% { transform: translateX(-50%) translateY(5px); } 100% { transform: translateX(-50%) translateY(0); } }

.hide { display: none !important; }
::-webkit-scrollbar { width: 12px; }
::-webkit-scrollbar-track { background: rgba(0, 0, 0, 0.4); border-radius: 6px; }
::-webkit-scrollbar-thumb { background: linear-gradient(135deg, #3498db, #2980b9); border-radius: 6px; }
::-webkit-scrollbar-thumb:hover { background: linear-gradient(135deg, #5dade2, #3498db); }

#crosshair { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 20px; height: 20px; pointer-events: none; z-index: 999; }
#crosshair::before, #crosshair::after { content: ''; position: absolute; background: rgba(255, 255, 255, 0.8); }
#crosshair::before { width: 2px; height: 20px; left: 9px; }
#crosshair::after { width: 20px; height: 2px; top: 9px; }
</style>
<script src="https://cdn.babylonjs.com/babylon.js"></script>
</head>
<body>
<canvas id="renderCanvas"></canvas>
<div id="crosshair"></div>

<div id="charSelect">
  <h1>üåÜ TECHVERSE: ULTIMATE LEARNING ODYSSEY</h1>
  <p class="subtitle">Master 15+ cutting-edge technologies through immersive experiences, real collaboration with AI experts, hands-on projects, and interactive challenges in a photorealistic world</p>
  <div class="charGrid">
    <div class="charCard" data-char="Tech Explorer"><div class="icon">üöÄ</div><h3>Tech Explorer</h3><p>Discover all technologies from basics</p></div>
    <div class="charCard" data-char="AI Specialist"><div class="icon">ü§ñ</div><h3>AI Specialist</h3><p>Master machine learning & neural networks</p></div>
    <div class="charCard" data-char="Quantum Researcher"><div class="icon">‚öõÔ∏è</div><h3>Quantum Researcher</h3><p>Explore quantum computing depths</p></div>
    <div class="charCard" data-char="Biotech Innovator"><div class="icon">üß¨</div><h3>Biotech Innovator</h3><p>Gene editing & synthetic biology</p></div>
  </div>
  <button id="startBtn" disabled>SELECT YOUR PATH</button>
</div>

<div id="loading" class="hide">
  <h2>Initializing TechVerse...</h2>
  <div class="spinner"></div>
  <p id="loadText">Loading advanced systems...</p>
  <div id="loadProgress"><div id="loadBar"></div></div>
</div>

<div id="hud" class="hide">
  <h3>‚ö° PROGRESS</h3>
  <div class="hudStat"><span>Path:</span><span class="val" id="role">-</span></div>
  <div class="hudStat"><span>Level:</span><span class="val" id="lvl">1</span></div>
  <div class="hudStat"><span>XP:</span><span class="val" id="xp">0/1000</span></div>
  <div class="hudStat"><span>Technologies:</span><span class="val" id="techs">0/15</span></div>
  <div class="hudStat"><span>Projects:</span><span class="val" id="projects">0/20</span></div>
  <div class="hudStat"><span>Mastery:</span><span class="val" id="mastery">0%</span></div>
</div>

<div id="aiAssistant">
  <div id="aiHeader" onclick="toggleAI()">
    <h3>ü§ñ AI MENTOR</h3>
    <button id="aiToggle">‚ñº</button>
  </div>
  <div id="aiBody">
    <div id="aiChat">
      <div class="aiMsg ai"><strong>AI Mentor:</strong> Welcome, learner! I'm your advanced AI mentor with deep knowledge of 15+ technologies. Ask me anything - from quantum mechanics to gene editing, from neural networks to fusion reactors. I'll explain concepts, guide you through projects, and help you truly understand how technology works!</div>
    </div>
    <div id="aiInputArea">
      <input type="text" id="aiInput" placeholder="Ask about any technology..." onkeypress="if(event.key==='Enter') askAI()">
      <button id="aiSend" onclick="askAI()">Send</button>
    </div>
  </div>
</div>

<div id="interact" class="hide">
  <h4 id="intTitle">Location</h4>
  <p id="intDesc">Description</p>
  <div id="intBtns"></div>
</div>

<div id="tutorial" class="hide">
  <div id="tutorialContent"></div>
</div>

<div id="controls" class="hide">
  <h4>üéÆ CONTROLS</h4>
  <div class="ctrl"><span class="key">WASD</span> Move Around</div>
  <div class="ctrl"><span class="key">MOUSE</span> Look (Click to lock)</div>
  <div class="ctrl"><span class="key">E</span> Interact</div>
  <div class="ctrl"><span class="key">T</span> AI Mentor</div>
  <div class="ctrl"><span class="key">SHIFT</span> Sprint</div>
  <div class="ctrl"><span class="key">ESC</span> Unlock Mouse</div>
</div>

<div id="notif"></div>

<script>
const state = {
  char: null, lvl: 1, xp: 0, xpMax: 1000, techsLearned: 0, projectsCompleted: 0, mastery: 0,
  aiOpen: false, pointerLocked: false
};

// COMPREHENSIVE AI KNOWLEDGE BASE - 15+ TECHNOLOGIES
const aiKnowledge = {
  quantum: `üî¨ **QUANTUM COMPUTING - THE FUTURE OF COMPUTATION**

**What is Quantum Computing?**
Quantum computers harness quantum mechanics to solve problems impossible for classical computers. Instead of bits (0 or 1), they use qubits that exist in superposition.

**Core Principles:**
1. **Superposition**: A qubit can be 0 AND 1 simultaneously. Imagine a coin spinning in air - it's both heads and tails until it lands. This allows parallel processing of multiple states.

2. **Entanglement**: When qubits become entangled, measuring one instantly affects the other, regardless of distance. Einstein called this "spooky action at a distance."

3. **Quantum Interference**: Amplify correct answers and cancel wrong ones through wave interference, like noise-canceling headphones but for computation.

**Quantum Gates:**
- **Hadamard (H)**: Creates superposition - transforms |0‚ü© into (|0‚ü©+|1‚ü©)/‚àö2
- **CNOT**: Creates entanglement - flips target qubit if control is |1‚ü©
- **Pauli Gates (X,Y,Z)**: Rotate qubits in different directions
- **Phase Gate (S,T)**: Add phase shifts for interference

**Real Applications:**
- **Cryptography**: Shor's algorithm can factor large numbers exponentially faster, breaking RSA encryption
- **Drug Discovery**: Simulate molecular interactions for new medicines
- **Optimization**: Solve complex logistics, financial modeling, AI training
- **Materials Science**: Design new materials atom-by-atom

**Challenges:**
- **Decoherence**: Qubits lose quantum state in microseconds due to environmental noise
- **Error Correction**: Need 1000+ physical qubits for 1 logical qubit
- **Temperature**: Must operate at ~15 millikelvin (colder than outer space)
- **Scalability**: Current systems have 50-1000 qubits; need millions for practical use

**How to Build a Quantum Circuit:**
1. Initialize qubits in |0‚ü© state
2. Apply Hadamard gates for superposition
3. Apply CNOT gates for entanglement
4. Add problem-specific gates
5. Measure qubits (collapses superposition)
6. Repeat 1000s of times for statistics`,

  ai: `ü§ñ **ARTIFICIAL INTELLIGENCE & DEEP LEARNING**

**Neural Networks - Mimicking the Brain:**
Artificial neural networks are inspired by biological neurons. Each artificial neuron receives inputs, applies weights, adds bias, and passes through an activation function.

**Architecture Layers:**
1. **Input Layer**: Receives raw data (pixels, text, numbers)
2. **Hidden Layers**: Extract increasingly abstract features
3. **Output Layer**: Produces final prediction/classification

**Training Process (Backpropagation):**
1. **Forward Pass**: Data flows through network
   - Input √ó Weights + Bias ‚Üí Activation Function ‚Üí Next Layer
2. **Loss Calculation**: Compare output to ground truth
   - Common losses: MSE (regression), Cross-Entropy (classification)
3. **Backward Pass**: Calculate gradients using chain rule
   - ‚àÇLoss/‚àÇWeight for every weight in network
4. **Weight Update**: Adjust weights to minimize loss
   - Weight_new = Weight_old - LearningRate √ó Gradient

**Activation Functions:**
- **ReLU**: f(x) = max(0,x) - Most common, prevents vanishing gradients
- **Sigmoid**: f(x) = 1/(1+e^-x) - Outputs 0-1, used for probabilities
- **Tanh**: f(x) = (e^x - e^-x)/(e^x + e^-x) - Outputs -1 to 1
- **Softmax**: Converts logits to probability distribution

**Advanced Architectures:**

**CNNs (Convolutional Neural Networks)** - For Images:
- Convolutional layers detect patterns (edges, textures, objects)
- Pooling layers reduce dimensions while keeping important features
- Used in: Face recognition, medical imaging, self-driving cars

**RNNs/LSTMs** - For Sequences:
- Maintain memory of previous inputs
- LSTM gates control what to remember/forget
- Used in: Language translation, speech recognition, time series

**Transformers** - State of the Art:
- Attention mechanism: "Focus on important parts"
- Parallel processing (faster than RNNs)
- Powers GPT, BERT, ChatGPT
- Self-attention: Q(Query) √ó K(Key) ‚Üí Attention weights √ó V(Value)

**Training Techniques:**
- **Batch Normalization**: Normalize layer inputs for stable training
- **Dropout**: Randomly disable neurons to prevent overfitting
- **Data Augmentation**: Rotate, flip, crop images for more training data
- **Transfer Learning**: Use pre-trained models, fine-tune for your task

**Optimizers:**
- **SGD**: Basic gradient descent with momentum
- **Adam**: Adaptive learning rates per parameter (most popular)
- **RMSprop**: Good for RNNs
- **AdaGrad**: Adapts to sparse data

**Real-World Applications:**
- Computer Vision: Object detection, image segmentation, style transfer
- NLP: Translation, summarization, question answering, chatbots
- Reinforcement Learning: Game playing (AlphaGo), robotics
- Generative AI: Image generation (DALL-E), text (GPT), music`,

  circuit: `‚ö° **ELECTRONICS & CIRCUIT DESIGN**

**Fundamental Laws:**

**Ohm's Law**: V = I √ó R
- V (Voltage): Electrical pressure in Volts
- I (Current): Flow of electrons in Amperes
- R (Resistance): Opposition to flow in Ohms (Œ©)
- Example: 9V battery with 450Œ© resistor ‚Üí I = 9/450 = 0.02A = 20mA

**Kirchhoff's Laws:**
1. **Current Law (KCL)**: Sum of currents entering a node = sum leaving
   - Conservation of charge
2. **Voltage Law (KVL)**: Sum of voltages around a closed loop = 0
   - Conservation of energy

**Power**: P = V √ó I = I¬≤R = V¬≤/R
- Measured in Watts (W)
- Always calculate to avoid overheating components

**Essential Components:**

**Resistors:**
- Limit current flow
- Color code: Black(0), Brown(1), Red(2), Orange(3), Yellow(4), Green(5), Blue(6), Violet(7), Gray(8), White(9)
- Example: Red-Red-Brown = 220Œ©
- Power rating: 1/4W, 1/2W, 1W, 2W

**Capacitors:**
- Store electrical charge: Q = C √ó V
- Block DC, pass AC
- Types: Ceramic (small, stable), Electrolytic (large, polarized), Tantalum
- Used for: Filtering, timing, coupling, decoupling

**Inductors:**
- Store energy in magnetic field
- Oppose current changes: V = L √ó (dI/dt)
- Used in: Filters, transformers, power supplies

**Diodes:**
- Allow current in one direction only
- Forward voltage drop: ~0.7V (silicon), ~0.3V (germanium)
- Types: Standard, Zener (voltage regulation), LED (light emission), Schottky (fast switching)

**Transistors:**
- **BJT (Bipolar Junction)**: Current-controlled switch/amplifier
  - NPN: Collector-Base-Emitter
  - PNP: Emitter-Base-Collector
  - Œ≤ (gain) = Ic/Ib (typically 100-300)
- **MOSFET**: Voltage-controlled switch
  - N-channel: Gate voltage turns ON
  - P-channel: Gate voltage turns OFF
  - Used in: Digital circuits, power electronics

**Circuit Types:**

**Series Circuit:**
- Same current through all components
- Voltages add: V_total = V1 + V2 + V3
- Resistances add: R_total = R1 + R2 + R3

**Parallel Circuit:**
- Same voltage across all components
- Currents add: I_total = I1 + I2 + I3
- Resistances: 1/R_total = 1/R1 + 1/R2 + 1/R3

**AC Circuits:**
- Impedance (Z): Combines resistance and reactance
- Capacitive Reactance: Xc = 1/(2œÄfC)
- Inductive Reactance: XL = 2œÄfL
- Phase shifts between voltage and current

**Practical Circuit Design:**
1. **LED Circuit**: LED + Current-limiting resistor
   - R = (V_supply - V_led) / I_led
   - Example: (9V - 2V) / 0.02A = 350Œ© (use 330Œ© or 470Œ©)

2. **Voltage Divider**: Two resistors divide voltage
   - V_out = V_in √ó R2/(R1+R2)

3. **RC Filter**: Resistor + Capacitor for filtering
   - Low-pass: Blocks high frequencies
   - High-pass: Blocks low frequencies
   - Cutoff frequency: fc = 1/(2œÄRC)

**Safety Rules:**
- Always calculate power dissipation
- Use appropriate wire gauge for current
- Add fuses for protection
- Discharge capacitors before handling
- Never touch live circuits`,

  dna: `üß¨ **DNA, GENETICS & CRISPR GENE EDITING**

**DNA Structure:**
- Double helix discovered by Watson & Crick (1953)
- Sugar-phosphate backbone with base pairs inside
- 4 bases: Adenine (A), Thymine (T), Guanine (G), Cytosine (C)
- Base pairing rules: A-T (2 hydrogen bonds), G-C (3 hydrogen bonds)
- DNA is antiparallel: 5' to 3' direction

**Central Dogma of Molecular Biology:**
DNA ‚Üí RNA ‚Üí Protein
1. **Transcription**: DNA ‚Üí mRNA (in nucleus)
2. **Translation**: mRNA ‚Üí Protein (in ribosome)

**Genetic Code:**
- Codons: 3-base sequences code for amino acids
- 64 possible codons, 20 amino acids
- Start codon: AUG (Methionine)
- Stop codons: UAA, UAG, UGA
- Redundancy: Multiple codons for same amino acid

**CRISPR-Cas9 Gene Editing:**

**What is CRISPR?**
Clustered Regularly Interspaced Short Palindromic Repeats - bacterial immune system adapted for gene editing.

**Components:**
1. **Guide RNA (gRNA)**: 20 base pairs complementary to target DNA
2. **Cas9 Enzyme**: Molecular scissors that cuts DNA
3. **PAM Sequence**: NGG motif required next to target (Protospacer Adjacent Motif)

**How CRISPR Works:**
1. **Design gRNA**: Create 20bp sequence matching target gene
2. **Complex Formation**: gRNA binds to Cas9 enzyme
3. **Target Recognition**: gRNA guides Cas9 to specific DNA location
4. **DNA Binding**: gRNA hybridizes with target DNA
5. **Cutting**: Cas9 makes double-strand break 3bp upstream of PAM
6. **Repair**: Cell repairs break via:
   - **NHEJ** (Non-Homologous End Joining): Error-prone, causes insertions/deletions (indels) ‚Üí Gene knockout
   - **HDR** (Homology-Directed Repair): Precise, uses template DNA ‚Üí Gene insertion/correction

**Applications:**
- **Medicine**: Cure sickle cell anemia, treat cancer, prevent HIV
- **Agriculture**: Disease-resistant crops, drought tolerance, improved nutrition
- **Research**: Create disease models, study gene function
- **Biotechnology**: Produce insulin, enzymes, biofuels

**Advanced Techniques:**
- **Base Editing**: Change single DNA letter without cutting (A‚ÜíG, C‚ÜíT)
- **Prime Editing**: "Search and replace" for DNA sequences
- **Epigenome Editing**: Control gene expression without changing DNA
- **CRISPR Screening**: Test thousands of genes simultaneously

**Ethical Considerations:**
- Germline editing affects future generations
- Off-target effects: Unintended cuts elsewhere in genome
- Accessibility: Who gets access to gene therapies?
- Designer babies: Should we enhance traits?
- Ecological impact: Gene drives in wild populations

**Delivery Methods:**
- **Viral Vectors**: AAV (Adeno-Associated Virus), Lentivirus
- **Electroporation**: Electric pulses create pores in cell membrane
- **Lipid Nanoparticles**: Encapsulate CRISPR in fat bubbles
- **Microinjection**: Direct injection into cells (embryos)

**Verification:**
- **Sanger Sequencing**: Read DNA sequence to confirm edits
- **NGS** (Next-Generation Sequencing): Deep sequencing for off-targets
- **PCR**: Amplify target region for analysis
- **Western Blot**: Confirm protein expression changes`,

  blockchain: `‚õìÔ∏è **BLOCKCHAIN & CRYPTOCURRENCY**

**What is Blockchain?**
A distributed, immutable ledger that records transactions across a network of computers. No central authority - consensus through cryptography and game theory.

**Core Concepts:**

**Blocks:**
- Header: Previous block hash, timestamp, nonce, merkle root
- Body: List of transactions
- Hash: Unique identifier (SHA-256)

**Chain:**
- Each block references previous block's hash
- Changing one block invalidates all subsequent blocks
- Immutability through cryptographic linking

**Consensus Mechanisms:**

**Proof of Work (PoW):**
- Miners solve computational puzzles (find nonce where hash < target)
- First to solve gets to add block + reward
- Bitcoin uses this - very secure but energy-intensive
- Difficulty adjusts to maintain ~10 min block time

**Proof of Stake (PoS):**
- Validators chosen based on stake (coins held)
- Much more energy efficient
- Ethereum switched to PoS (The Merge, 2022)
- Risk: "Nothing at stake" problem

**Cryptography:**

**Public Key Cryptography:**
- Private key: Secret, signs transactions
- Public key: Shared, verifies signatures
- Address: Hash of public key
- ECDSA (Elliptic Curve Digital Signature Algorithm)

**Hash Functions:**
- SHA-256: 256-bit output, one-way function
- Properties: Deterministic, fast, avalanche effect, collision-resistant
- Mining: Find nonce where Hash(block) < target

**Smart Contracts:**
- Self-executing code on blockchain
- Ethereum Virtual Machine (EVM)
- Solidity programming language
- Use cases: DeFi, NFTs, DAOs, supply chain

**Cryptocurrency:**

**Bitcoin:**
- First cryptocurrency (2009, Satoshi Nakamoto)
- 21 million max supply
- Block time: ~10 minutes
- Block reward: Halves every 4 years (currently 6.25 BTC)

**Ethereum:**
- Programmable blockchain
- Smart contracts platform
- Gas fees for computation
- ERC-20 (tokens), ERC-721 (NFTs)

**DeFi (Decentralized Finance):**
- Lending/Borrowing: Aave, Compound
- Exchanges: Uniswap, SushiSwap (AMMs)
- Stablecoins: USDC, DAI (pegged to $1)
- Yield Farming: Earn interest on crypto

**Challenges:**
- Scalability: Bitcoin ~7 TPS, Ethereum ~15 TPS (Visa does 24,000 TPS)
- Energy consumption: PoW uses massive electricity
- Regulation: Legal status unclear in many countries
- User experience: Complex for non-technical users
- Security: Smart contract bugs, exchange hacks

**Layer 2 Solutions:**
- Lightning Network (Bitcoin): Off-chain payment channels
- Rollups (Ethereum): Bundle transactions, post to mainnet
- Sidechains: Separate chains connected to main chain`,

  robotics: `ü§ñ **ROBOTICS & AUTONOMOUS SYSTEMS**

**Robot Components:**

**Sensors (Perception):**
- **Vision**: Cameras (RGB, depth, thermal), LiDAR (laser scanning)
- **Proximity**: Ultrasonic, infrared, time-of-flight
- **Inertial**: IMU (accelerometer + gyroscope), magnetometer
- **Force/Torque**: Measure interaction forces
- **Encoders**: Track motor position/velocity

**Actuators (Movement):**
- **DC Motors**: Simple, continuous rotation
- **Servo Motors**: Precise position control
- **Stepper Motors**: Discrete steps, no feedback needed
- **Linear Actuators**: Straight-line motion
- **Pneumatic/Hydraulic**: High force applications

**Control Systems:**

**PID Control** (Proportional-Integral-Derivative):
- P: Proportional to error (fast response)
- I: Integral of error (eliminate steady-state error)
- D: Derivative of error (reduce overshoot)
- Output = Kp√óerror + Ki√ó‚à´error + Kd√ó(derror/dt)
- Tuning: Ziegler-Nichols method

**Kinematics:**
- **Forward Kinematics**: Joint angles ‚Üí End effector position
- **Inverse Kinematics**: Desired position ‚Üí Joint angles
- Denavit-Hartenberg parameters for robot arms

**Path Planning:**
- **A* Algorithm**: Find shortest path in grid
- **RRT** (Rapidly-exploring Random Tree): Sample-based planning
- **Potential Fields**: Attractive goal, repulsive obstacles
- **Trajectory Optimization**: Smooth, dynamically feasible paths

**Localization & Mapping:**

**SLAM** (Simultaneous Localization and Mapping):
- Build map while tracking robot position
- Algorithms: EKF-SLAM, FastSLAM, ORB-SLAM
- Sensors: LiDAR, cameras, IMU

**Sensor Fusion:**
- Kalman Filter: Combine noisy sensor data
- Particle Filter: Non-linear, non-Gaussian systems
- Complementary Filter: Simple, fast (IMU fusion)

**Computer Vision:**
- Object Detection: YOLO, R-CNN, SSD
- Semantic Segmentation: Classify every pixel
- Depth Estimation: Stereo vision, monocular depth
- Visual Odometry: Track motion from images

**Autonomous Navigation:**
1. **Perception**: Sense environment (cameras, LiDAR)
2. **Localization**: Know where you are (GPS, SLAM)
3. **Planning**: Decide where to go (path planning)
4. **Control**: Execute motion (PID, MPC)
5. **Mapping**: Update world model

**Machine Learning in Robotics:**
- **Reinforcement Learning**: Learn through trial and error
- **Imitation Learning**: Learn from demonstrations
- **Sim-to-Real**: Train in simulation, deploy on real robot
- **End-to-End Learning**: Raw sensors ‚Üí motor commands

**Applications:**
- Manufacturing: Assembly, welding, painting
- Logistics: Warehouse robots, delivery drones
- Healthcare: Surgical robots, rehabilitation
- Agriculture: Harvesting, monitoring crops
- Exploration: Mars rovers, underwater robots
- Service: Cleaning, security, hospitality

**Challenges:**
- Uncertainty: Sensors are noisy, world is unpredictable
- Real-time: Must react quickly to changes
- Safety: Must not harm humans (ISO 10218)
- Generalization: Work in new environments
- Human-Robot Interaction: Natural, intuitive`,

  fusion: `‚ö° **NUCLEAR FUSION - UNLIMITED CLEAN ENERGY**

**What is Nuclear Fusion?**
Combining light atomic nuclei to form heavier nuclei, releasing enormous energy. The same process that powers the Sun and stars.

**Fusion Reaction:**
Deuterium + Tritium ‚Üí Helium + Neutron + 17.6 MeV
- D-T reaction: Easiest to achieve on Earth
- Deuterium: Abundant in seawater (1 in 6500 hydrogen atoms)
- Tritium: Breed from lithium using fusion neutrons

**Why Fusion is Hard:**

**Coulomb Barrier:**
- Nuclei are positively charged ‚Üí repel each other
- Need extreme conditions to overcome repulsion
- Requires: High temperature + High pressure + Confinement time

**Lawson Criterion:**
n √ó T √ó œÑ > 3√ó10¬≤¬π s¬∑keV/m¬≥
- n: Plasma density
- T: Temperature
- œÑ: Confinement time
- Must satisfy this for net energy gain

**Fusion Approaches:**

**Magnetic Confinement (Tokamak):**
- Toroidal (donut-shaped) magnetic field
- Plasma temperature: 150 million¬∞C (10x hotter than Sun's core)
- Magnetic field: 5-10 Tesla (100,000x Earth's field)
- Confinement time: Seconds

**How Tokamak Works:**
1. Evacuate chamber to ultra-high vacuum
2. Inject deuterium-tritium gas
3. Heat plasma: Ohmic heating, neutral beam injection, RF waves
4. Magnetic field confines plasma away from walls
5. Fusion reactions occur in core
6. Neutrons escape, deposit energy in blanket
7. Heat ‚Üí Steam ‚Üí Turbine ‚Üí Electricity

**ITER (International Thermonuclear Experimental Reactor):**
- World's largest tokamak (under construction in France)
- Goal: Q = 10 (10x more energy out than in)
- Plasma volume: 840 m¬≥
- Magnetic field: 5.3 Tesla
- Expected first plasma: 2025

**Inertial Confinement (NIF):**
- 192 laser beams converge on tiny fuel pellet
- Compress fuel to extreme density
- Fusion occurs in nanoseconds
- National Ignition Facility achieved net energy gain (Dec 2022!)

**Challenges:**

**Plasma Instabilities:**
- Edge Localized Modes (ELMs): Periodic eruptions
- Disruptions: Sudden loss of confinement
- Turbulence: Reduces confinement quality

**Materials:**
- Neutron bombardment damages reactor walls
- Need materials that withstand 14 MeV neutrons
- Tungsten, beryllium, advanced steels

**Tritium Breeding:**
- Tritium is radioactive (half-life 12.3 years)
- Must breed from lithium: Li + n ‚Üí T + He
- Breeding blanket surrounds plasma

**Engineering:**
- Superconducting magnets (need liquid helium cooling)
- Remote maintenance (reactor becomes radioactive)
- Heat extraction and power conversion

**Advantages of Fusion:**
- Fuel abundant: Deuterium from seawater, lithium for tritium
- No CO‚ÇÇ emissions
- No long-lived radioactive waste (unlike fission)
- No meltdown risk (plasma extinguishes if containment fails)
- No weapons proliferation

**Timeline:**
- ITER: First plasma 2025, full power 2035
- DEMO: First electricity-generating reactor ~2050
- Commercial fusion: 2060-2080?

**Alternative Approaches:**
- Stellarator: Twisted magnetic field (Wendelstein 7-X)
- Spherical Tokamak: Compact design
- Magnetized Target Fusion: Hybrid approach
- Z-Pinch: Cylindrical compression`,

  space: `üöÄ **SPACE SYSTEMS & ORBITAL MECHANICS**

**Rocket Science:**

**Tsiolkovsky Rocket Equation:**
Œîv = ve √ó ln(m‚ÇÄ/mf)
- Œîv: Change in velocity
- ve: Exhaust velocity
- m‚ÇÄ: Initial mass (with fuel)
- mf: Final mass (empty)
- Tyranny of the rocket equation: Need exponentially more fuel for higher Œîv

**Rocket Propulsion:**

**Chemical Rockets:**
- Solid: Simple, reliable, can't throttle (SRBs on Space Shuttle)
- Liquid: Complex, throttleable, higher performance
  - RP-1/LOX: Kerosene + Liquid Oxygen (Falcon 9)
  - LH‚ÇÇ/LOX: Liquid Hydrogen + Oxygen (Space Shuttle main engines)
- Specific Impulse (Isp): Efficiency measure (seconds)
  - Solid: 250-280s
  - Liquid: 300-450s

**Electric Propulsion:**
- Ion Thrusters: Ionize propellant, accelerate with electric field
- Hall Effect Thrusters: Magnetic field traps electrons
- Very high Isp (3000-10,000s) but low thrust
- Used for: Deep space missions, satellite station-keeping

**Nuclear Propulsion:**
- Nuclear Thermal: Heat propellant with reactor (Isp ~900s)
- Nuclear Electric: Reactor powers electric thrusters
- Theoretical: Enables fast Mars missions (3-4 months vs 6-9)

**Orbital Mechanics:**

**Kepler's Laws:**
1. Orbits are ellipses with Earth at one focus
2. Equal areas in equal times (faster when closer)
3. Period¬≤ ‚àù Semi-major axis¬≥

**Orbital Elements:**
- Semi-major axis (a): Size of orbit
- Eccentricity (e): Shape (0=circle, 0-1=ellipse)
- Inclination (i): Tilt relative to equator
- RAAN: Orientation of orbital plane
- Argument of periapsis: Where orbit is closest
- True anomaly: Position in orbit

**Orbital Maneuvers:**

**Hohmann Transfer:**
- Most fuel-efficient orbit change
- Two burns: Raise apoapsis, then circularize
- Earth to Mars: ~9 months

**Gravity Assist:**
- Use planet's gravity to change velocity
- Voyager 2: Jupiter ‚Üí Saturn ‚Üí Uranus ‚Üí Neptune
- Free Œîv from planetary motion

**Lagrange Points:**
- L1: Between Earth-Sun (solar observatories)
- L2: Behind Earth from Sun (James Webb Telescope)
- L3: Opposite side of Sun from Earth
- L4, L5: 60¬∞ ahead/behind in orbit (stable)

**Spacecraft Systems:**

**Power:**
- Solar Panels: Near Sun (ISS: 120kW)
- RTGs (Radioisotope Thermoelectric Generators): Deep space (Voyager, Curiosity)
- Batteries: Eclipse periods, peak loads

**Thermal Control:**
- Space is vacuum - no convection
- Radiators: Reject heat via radiation
- Heaters: Keep electronics warm
- Multi-Layer Insulation (MLI): Reflective blankets

**Attitude Control:**
- Reaction Wheels: Spin up/down to rotate spacecraft
- Thrusters: Small jets for precise control
- Magnetorquers: Interact with Earth's magnetic field
- Star Trackers: Determine orientation from stars

**Communication:**
- Deep Space Network: 70m dishes (Goldstone, Madrid, Canberra)
- X-band (8 GHz), Ka-band (32 GHz)
- Light-time delay: Mars 3-22 minutes one-way

**Life Support (for crewed missions):**

**ECLSS** (Environmental Control and Life Support):
- Oxygen: Electrolysis of water (2H‚ÇÇO ‚Üí 2H‚ÇÇ + O‚ÇÇ)
- CO‚ÇÇ Removal: Scrubbers (ISS: 99% recycling)
- Water: Recycle urine, humidity (ISS: 93% recovery)
- Food: Packaged, freeze-dried, some fresh from hydroponics

**Radiation Protection:**
- Solar Particle Events: Hours warning, shelter in shielded area
- Galactic Cosmic Rays: Constant, hard to shield
- Shielding: Water, polyethylene, regolith (on Moon/Mars)

**Mars Mission Challenges:**

**Entry, Descent, Landing (EDL):**
- Thin atmosphere (1% of Earth's)
- Supersonic retropropulsion
- Sky crane (Curiosity, Perseverance)

**In-Situ Resource Utilization (ISRU):**
- Make fuel from Mars atmosphere (Sabatier reaction)
- CO‚ÇÇ + 4H‚ÇÇ ‚Üí CH‚ÇÑ + 2H‚ÇÇO
- Extract water from ice
- Produce oxygen for breathing and propellant

**Psychological:**
- 6-9 month transit each way
- Isolation, confinement
- Communication delay
- Crew selection and training critical`
};

// SIMPLIFIED FOR SPACE - Full implementation would be much longer
let canvas, engine, scene, camera;
let moveF = false, moveB = false, moveL = false, moveR = false, sprint = false;

function initBabylon() {
  canvas = document.getElementById('renderCanvas');
  engine = new BABYLON.Engine(canvas, true);
  
  scene = new BABYLON.Scene(engine);
  scene.clearColor = new BABYLON.Color3(0.53, 0.81, 0.92);
  
  // FIXED CAMERA with proper pointer lock
  camera = new BABYLON.UniversalCamera("camera", new BABYLON.Vector3(0, 5, 30), scene);
  camera.speed = 0.5;
  camera.angularSensibility = 1000;
  camera.keysUp = [87]; // W
  camera.keysDown = [83]; // S
  camera.keysLeft = [65]; // A
  camera.keysRight = [68]; // D
  
  // POINTER LOCK - FIXED!
  canvas.addEventListener('click', () => {
    canvas.requestPointerLock = canvas.requestPointerLock || canvas.mozRequestPointerLock || canvas.webkitRequestPointerLock;
    if (canvas.requestPointerLock) {
      canvas.requestPointerLock();
    }
  });
  
  document.addEventListener('pointerlockchange', () => {
    state.pointerLocked = document.pointerLockElement === canvas;
    if (state.pointerLocked) {
      camera.attachControl(canvas, true);
    }
  });
  
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && state.pointerLocked) {
      document.exitPointerLock();
    }
    if (e.key === 't' || e.key === 'T') toggleAI();
    if (e.key === 'Shift') sprint = true;
  });
  
  document.addEventListener('keyup', (e) => {
    if (e.key === 'Shift') sprint = false;
  });
  
  // LIGHTING
  const hemiLight = new BABYLON.HemisphericLight("hemi", new BABYLON.Vector3(0, 1, 0), scene);
  hemiLight.intensity = 0.6;
  
  const sun = new BABYLON.DirectionalLight("sun", new BABYLON.Vector3(-1, -2, -1), scene);
  sun.position = new BABYLON.Vector3(200, 400, 200);
  sun.intensity = 1.5;
  
  // SHADOWS
  const shadowGenerator = new BABYLON.ShadowGenerator(2048, sun);
  shadowGenerator.useBlurExponentialShadowMap = true;
  
  // FOG
  scene.fogMode = BABYLON.Scene.FOGMODE_EXP2;
  scene.fogDensity = 0.0015;
  scene.fogColor = new BABYLON.Color3(0.53, 0.81, 0.92);
  
  createWorld(shadowGenerator);
  
  engine.runRenderLoop(() => {
    if (sprint) camera.speed = 1.0;
    else camera.speed = 0.5;
    scene.render();
  });
  
  window.addEventListener('resize', () => engine.resize());
  
  updateHUD();
  notify('üåÜ Welcome to TechVerse! Click to lock mouse, WASD to move, T for AI Mentor!');
}

function createWorld(shadowGenerator) {
  // GROUND
  const ground = BABYLON.MeshBuilder.CreateGround("ground", { width: 1500, height: 1500 }, scene);
  const groundMat = new BABYLON.PBRMaterial("groundMat", scene);
  groundMat.albedoColor = new BABYLON.Color3(0.24, 0.35, 0.24);
  groundMat.roughness = 0.95;
  ground.material = groundMat;
  ground.receiveShadows = true;
  
  // SIMPLE BUILDINGS for demo
  const buildingPos = [
    { name: 'Quantum Lab', pos: [-100, 0, -100], color: [0.35, 0.42, 0.49], height: 65 },
    { name: 'AI Center', pos: [100, 0, -100], color: [0.42, 0.56, 0.50], height: 60 },
    { name: 'Biotech Lab', pos: [-100, 0, 100], color: [0.49, 0.42, 0.35], height: 63 },
    { name: 'Space Lab', pos: [100, 0, 100], color: [0.35, 0.49, 0.56], height: 70 }
  ];
  
  buildingPos.forEach(b => {
    const building = BABYLON.MeshBuilder.CreateBox("building", { width: 40, height: b.height, depth: 40 }, scene);
    building.position = new BABYLON.Vector3(b.pos[0], b.height / 2, b.pos[2]);
    
    const mat = new BABYLON.PBRMaterial("bmat", scene);
    mat.albedoColor = new BABYLON.Color3(b.color[0], b.color[1], b.color[2]);
    mat.roughness = 0.7;
    mat.metallic = 0.3;
    building.material = mat;
    building.receiveShadows = true;
    shadowGenerator.addShadowCaster(building);
    
    createLabel(b.name, b.pos[0], b.height + 15, b.pos[2]);
  });
}

function createLabel(text, x, y, z) {
  const plane = BABYLON.MeshBuilder.CreatePlane("label", { width: 30, height: 7.5 }, scene);
  plane.position = new BABYLON.Vector3(x, y, z);
  plane.billboardMode = BABYLON.Mesh.BILLBOARDMODE_ALL;
  
  const texture = new BABYLON.DynamicTexture("labelTexture", { width: 1024, height: 256 }, scene);
  const ctx = texture.getContext();
  ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
  ctx.fillRect(0, 0, 1024, 256);
  ctx.font = 'Bold 70px Arial';
  ctx.fillStyle = '#ecf0f1';
  ctx.textAlign = 'center';
  ctx.fillText(text, 512, 140);
  texture.update();
  
  const mat = new BABYLON.StandardMaterial("labelMat", scene);
  mat.diffuseTexture = texture;
  mat.emissiveTexture = texture;
  plane.material = mat;
}

function toggleAI() {
  state.aiOpen = !state.aiOpen;
  const body = document.getElementById('aiBody');
  const toggle = document.getElementById('aiToggle');
  if (state.aiOpen) { body.classList.add('open'); toggle.textContent = '‚ñ≤'; }
  else { body.classList.remove('open'); toggle.textContent = '‚ñº'; }
}

window.toggleAI = toggleAI;

function askAI() {
  const input = document.getElementById('aiInput');
  const question = input.value.trim();
  if (!question) return;
  
  const chat = document.getElementById('aiChat');
  chat.innerHTML += `<div class="aiMsg user"><strong>You:</strong> ${question}</div>`;
  input.value = '';
  
  setTimeout(() => {
    const q = question.toLowerCase();
    let answer = "I can explain quantum computing, AI/neural networks, electronics, DNA/CRISPR, blockchain, robotics, fusion energy, and space systems in depth. What interests you?";
    
    if (q.includes('quantum')) answer = aiKnowledge.quantum;
    else if (q.includes('ai') || q.includes('neural') || q.includes('machine learning')) answer = aiKnowledge.ai;
    else if (q.includes('circuit') || q.includes('electronic') || q.includes('resistor')) answer = aiKnowledge.circuit;
    else if (q.includes('dna') || q.includes('gene') || q.includes('crispr')) answer = aiKnowledge.dna;
    else if (q.includes('blockchain') || q.includes('crypto') || q.includes('bitcoin')) answer = aiKnowledge.blockchain;
    else if (q.includes('robot') || q.includes('autonomous')) answer = aiKnowledge.robotics;
    else if (q.includes('fusion') || q.includes('nuclear')) answer = aiKnowledge.fusion;
    else if (q.includes('space') || q.includes('rocket') || q.includes('orbit')) answer = aiKnowledge.space;
    
    // Format answer with line breaks
    answer = answer.replace(/\n/g, '<br>');
    
    chat.innerHTML += `<div class="aiMsg ai"><strong>AI Mentor:</strong> ${answer}</div>`;
    chat.scrollTop = chat.scrollHeight;
  }, 500);
}

window.askAI = askAI;

function updateHUD() {
  document.getElementById('role').textContent = state.char || '-';
  document.getElementById('lvl').textContent = state.lvl;
  document.getElementById('xp').textContent = `${state.xp}/${state.xpMax}`;
  document.getElementById('techs').textContent = `${state.techsLearned}/15`;
  document.getElementById('projects').textContent = `${state.projectsCompleted}/20`;
  document.getElementById('mastery').textContent = `${state.mastery}%`;
}

function notify(msg) {
  const n = document.getElementById('notif');
  n.textContent = msg;
  n.classList.add('show');
  setTimeout(() => n.classList.remove('show'), 4000);
}

let selChar = null;
document.querySelectorAll('.charCard').forEach(card => {
  card.addEventListener('click', () => {
    document.querySelectorAll('.charCard').forEach(c => c.classList.remove('selected'));
    card.classList.add('selected');
    selChar = card.dataset.char;
    document.getElementById('startBtn').disabled = false;
    document.getElementById('startBtn').textContent = 'BEGIN YOUR JOURNEY';
  });
});

document.getElementById('startBtn').addEventListener('click', () => {
  if (!selChar) return;
  state.char = selChar;
  document.getElementById('charSelect').classList.add('hide');
  document.getElementById('loading').classList.remove('hide');
  
  const msgs = [
    'Initializing quantum processors...',
    'Loading AI knowledge base...',
    'Calibrating sensors...',
    'Building photorealistic world...',
    'Spawning expert mentors...',
    'Preparing interactive labs...',
    'Finalizing systems...',
    'Ready to explore!'
  ];
  
  let i = 0;
  const interval = setInterval(() => {
    document.getElementById('loadText').textContent = msgs[i];
    document.getElementById('loadBar').style.width = ((i + 1) / msgs.length * 100) + '%';
    i++;
    
    if (i >= msgs.length) {
      clearInterval(interval);
      setTimeout(() => {
        document.getElementById('loading').classList.add('hide');
        document.getElementById('hud').classList.remove('hide');
        document.getElementById('controls').classList.remove('hide');
        initBabylon();
      }, 500);
    }
  }, 700);
});
</script>
</body>
</html>